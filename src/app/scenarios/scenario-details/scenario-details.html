<div class="row">
    <div class="col s4">
        <a (click)="back()">< Back to list</a>
    </div>
</div>

<div class="row">
    <h3 class="col s5">New scenario</h3>
</div>

<form class="scenario-details" (ngSubmit)="save(scenario)">
    <div class="row">
        <div class="input-field col s6">
            <input id="first_name" type="text" placeholder="Enter descriptive scenario name"
                   [(ngModel)]="scenario.name"/>
            <label for="first_name">Scenario name:</label>
        </div>
    </div>
    <div>
        <div class="row">
            <div class="col">
                <h5>If condition is true</h5>
            </div>
        </div>

        <div class="row gray-bg" *ngFor="#condition of scenario.conditions">
            <div class="col s3">
                <span>Device</span>
                <select [(ngModel)]="condition.selectedDevice">
                    <option [value]="undefined">Choose trigger</option>
                    <option *ngFor="#device of condition.devices"
                            [value]="device._id">{{device.description}}</option>
                </select>
            </div>
            <div class="col s3">
                <span>Condition</span>
                <select [(ngModel)]="condition.selectedCondition">
                    <option [value]="undefined">Choose condition</option>
                    <option *ngFor="#condition of condition.conditions" [value]="condition.id">{{condition.name}}</option>
                </select>
            </div>
            <div class="col s5">
                <span>Value</span>
                <input type="text" placeholder="Enter value"
                       [(ngModel)]="condition.value"/>
            </div>
            <div class="col s1" *ngIf="scenario.conditions.length>1">
                <div>
                    <i class="material-icons center"
                       (click)="removeCriteria()"
                    >delete</i>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <a (click)="addCriteria()">+ ADD CRITERIA</a>
    </div>
    <div class="row">
        <div class="col">
            <h5>Then do the following</h5>
        </div>
    </div>
    <div class="row gray-bg" *ngFor="#action of scenario.actions">
        <div class="col s3">
            <span>Device</span>
            <select [(ngModel)]="action.selectedDevice">
                <option [value]="undefined">Choose device</option>
                <option *ngFor="#device of action.devices"
                        [value]="device._id">{{device.description}}</option>
            </select>
        </div>
        <div class="col s3">
            <span>Value</span>
            <select [(ngModel)]="action.selectedValue">
                <option *ngFor="#value of action.values">{{value.name}}</option>
            </select>
        </div>
        <div class="col s1" *ngIf="scenario.actions.length>1">
            <div>
                <i (click)="removeAction()" class="material-icons center">delete</i>
            </div>
        </div>
    </div>

    <div class="row">
        <a (click)="addAction()">+ ADD ACTION</a>
    </div>

    <div class="row">
        <div class="col s4">
            <button class="waves-effect waves-light btn blue lighten-1" type="submit">save</button>
        </div>
    </div>
</form>
